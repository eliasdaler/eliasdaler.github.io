<!DOCTYPE html>
<html lang="en-us">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Tomb Painter. The first dev log (2017-2018) &middot; Elias Daler's blog
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/videoWrapper.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
  <link rel="stylesheet" href="/css/main.css">

  <!-- Icons -->
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">

  <div class="sidebar-item">
    <h4 style="color:#FFFFFF;"><i class="fa fa-gamepad fa-3x" aria-hidden="true"></i><br>Elias Daler's blog
</h4>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/"><i class="fa fa-home fa-fw" aria-hidden="true"></i>&nbsp; Home</a>
    <a class="sidebar-nav-item" href="/re-creation/"><i class="fa fa-gamepad fa-fw" aria-hidden="true"></i>&nbsp; Re:creation</a>
    <a class="sidebar-nav-item" href="/programming-and-gamedev-resources/"><i class="fa fa-list-ul fa-fw" aria-hidden="true"></i>&nbsp; Programming and game dev resources</a>
    <a class="sidebar-nav-item" href="/about/"><i class="fa fa-user fa-fw" aria-hidden="true"></i>&nbsp; About</a>
    <a class="sidebar-nav-item" href="/tags/"><i class="fa fa-tags fa-fw" aria-hidden="true"></i>&nbsp; Tags</a>
  </nav>

  <div class="sidebar-item">
    <h5 style="color:#FFFFFF;">
      &copy; 2021. Elias Daler. All rights reserved.
    </h5>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Elias Daler's blog</a>
            <small></small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Tomb Painter. The first dev log (2017-2018)</h1>
    <span class="post-meta"><time datetime="2019-01-06T23:22:00+03:00" itemprop="datePublished"><i class="fa fa-calendar" aria-hidden="true"></i> Posted on <b>Jan 6, 2019</b></time></span>
<ul class="tags">
  
    <li><a href="/tags#Tomb+Painter" class="tag"><i class="fa fa-tag" aria-hidden="true"></i> Tomb Painter</a></li>
  
    <li><a href="/tags#dev+log" class="tag"><i class="fa fa-tag" aria-hidden="true"></i> dev log</a></li>
  
    <li><a href="/tags#C%2B%2B" class="tag"><i class="fa fa-tag" aria-hidden="true"></i> C++</a></li>
  
    <li><a href="/tags#Lua" class="tag"><i class="fa fa-tag" aria-hidden="true"></i> Lua</a></li>
  
    <li><a href="/tags#game+dev" class="tag"><i class="fa fa-tag" aria-hidden="true"></i> game dev</a></li>
  
</ul>
  </header>
  <hr>

  <div class="post-content" itemprop="articleBody">
    
<hr />

<p>Hello, everyone. Today I’m ready to officially announce and talk about the game I’m currently working on!</p>

<p><img src="/assets/tomb_painter_first_dev_log/tomb_painter_logo.png" alt="Tomb Painter logo" style="display:block; margin: 0 auto" /></p>

<p>It’s called Tomb Painter and I’ve been working on it since August of 2017.</p>

<p><img src="/assets/tomb_painter_first_dev_log/characters.png" alt="Tomb Painter characters" style="display:block; margin: 0 auto; width: 447px" /></p>

<p>In the game, a painter arrives on mysterious island, which has strange things going on with it. Blob-shaped monsters made of paint start to appear from an ancient tomb. The only way to stop this is to paint beautiful patterns which were washed away by a flood that happened some time ago.</p>

<p>The main mechanic is that you can draw on floors and paint stuff by hitting it with your brush. By painting on the floor, you solve different puzzles.
<img src="/assets/tomb_painter_first_dev_log/gameplay.gif" alt="Tomb Painter gameplay" style="display:block; margin: 0 auto; width: 512px" /></p>

<!--more-->
<p><a class="anchor" id="read-more"></a></p>

<h2 class="no_toc" id="table-of-contents">Table of contents</h2>

<ul id="markdown-toc">
  <li><a href="#start-of-development" id="markdown-toc-start-of-development">Start of development</a></li>
  <li><a href="#game--engine-separation" id="markdown-toc-game--engine-separation">Game / engine separation</a></li>
  <li><a href="#cmake--fetchcontent--third-party-dependencies" id="markdown-toc-cmake--fetchcontent--third-party-dependencies">CMake / FetchContent / Third party dependencies</a></li>
  <li><a href="#cutscene-system" id="markdown-toc-cutscene-system">Cutscene system</a></li>
  <li><a href="#quest-and-saving-system" id="markdown-toc-quest-and-saving-system">Quest and saving system</a></li>
  <li><a href="#replay-system" id="markdown-toc-replay-system">Replay system</a></li>
  <li><a href="#data--script-separation" id="markdown-toc-data--script-separation">Data / script separation</a></li>
  <li><a href="#other" id="markdown-toc-other">Other</a></li>
  <li><a href="#whats-next" id="markdown-toc-whats-next">What’s next?</a></li>
</ul>

<h2 id="start-of-development">Start of development</h2>

<p>I’ve started to work on this game, because developing <a href="https://eliasdaler.github.io/re-creation/">Re:creation</a> became too hard for me. It had gigantic scope and pretty detailed art, which took a long time to produce, so I’ve decided to make something simpler as my first game.</p>

<p>It all started with this prototype art, which was highly inspired by <a href="http://minitgame.com/">Minit</a>:</p>

<p><img src="/assets/tomb_painter_first_dev_log/tomb_painter_first_prototype.png" alt="Tomb Painter first prototype" style="display:block; margin: 0 auto; width: 480px" /></p>

<p>I was pretty surprised that so much can be accomplished with only two colors, but I wanted a bit more detail, so I’ve decided to use 4 colors, just like Game Boy did:</p>

<p><img src="/assets/tomb_painter_first_dev_log/tomb_painter_early.png" alt="Tomb Painter early prototype" style="display:block; margin: 0 auto; width: 480px" /></p>

<p><img src="/assets/tomb_painter_first_dev_log/early_gameplay.gif" alt="Tomb Painter early prototype" style="display:block; margin: 0 auto; width: 480px" /></p>

<p>The game’s internal resolution is 160x144 pixels, same as Game Boy again. I’ve decided not to follow all limitations of Game Boy, as it would be pretty hard to make a good looking game with them, but still, 4 colors and 160x144 is pretty limiting, while it can also look good. It also takes a lot less time to produce art.</p>

<p>I’ve also experimented with adding a second palette (just like Super Game Boy on SNES did) and it looked pretty interesting:</p>

<p><img src="/assets/tomb_painter_first_dev_log/early_gameplay2.gif" alty="Tomb Painter early prototype" style="display:block; margin: 0 auto; width: 480px" /></p>

<p>You can also see first painting system which was improved later.</p>

<p>So now I have two palettes with 4 colors each. The game is rendered in shades of grey and I can easily map each shade to whatever color I want to get different palettes, including the original Game Boy one:</p>

<p><img src="/assets/tomb_painter_first_dev_log/gameboy.png" alt="Tomb Painter characters" style="display:block; margin: 0 auto; width: 447px" /></p>

<p>I also made some simple shaders for fade in and fade out:</p>

<p><img src="/assets/tomb_painter_first_dev_log/fadein_fadeout.gif" alt="Tomb Painter fade in / fade out effects" style="display:block; margin: 0 auto; width: 480px" /></p>

<p>and for lighting simulation:</p>

<p><img src="/assets/tomb_painter_first_dev_log/light.gif" alt="Tomb Painter lighting" style="display:block; margin: 0 auto; width: 480px" /></p>

<p>It’s still 4 colors, but it looks pretty nice.</p>

<p>A lot of time was spent on making paint look and feel good. Note that the tiles of paint change depending on direction you’re painting in, so it looks like a continuous trail, and you can also have multiples layer of paint. The paint also changes the color of what’s below it and that was pretty interesting to implement too. I may write about all that shader magic in the future.</p>

<p><img src="/assets/tomb_painter_first_dev_log/painting.gif" alt="Tomb Painter painting system" style="display:block; margin: 0 auto; width: 480px" /></p>

<p>As for more technical details: I’ve used Re:creation’s engine and started to modify it as I needed. I had working prototype of Tomb Painter in two weeks and it felt good to not start from scratch. All the abstractions and worries about design were worth it!</p>

<p>I’ve improved the engine quite a lot and if I start to go over it all in detail, so I’ll make a short summary here, and if you want to have it explained in depth, ask about stuff you want to be covered in comments!</p>

<h2 id="game--engine-separation">Game / engine separation</h2>

<p>Right now I’m still working on better game / engine separation, but basically the engine is now a statically linked library. I’ve decided to call the engine <strong>EDGE</strong> (Elias Daler’s Game Engine). The “game” part is just several .cpp files and mostly just Lua code, because I prefer to code game logic in it. Once I feel that engine is decoupled enough and I have some time to make a simple game with it, I plan to open source the engine part!</p>

<h2 id="cmake--fetchcontent--third-party-dependencies">CMake / FetchContent / Third party dependencies</h2>

<p>I’ve learned a lot about CMake (thanks to <a href="https://crascit.com/professional-cmake/">Professional CMake book</a>) and finally achieved a perfect setup for me. I’ve managed to get all third party dependencies (9 of them) to be fetched at configure time. Then, I build all the dependencies and my game. It works perfectly - it’s easy to start with a clean folder and just build everything!
It’s also very easy to update to new versions of the libraries, here’s the only thing I need to do:</p>

<p><img src="/assets/tomb_painter_first_dev_log/changing_lib_versions.png" alt="Changing lib versions" style="display:block; margin: 0 auto; width: 360px" /></p>

<h2 id="cutscene-system">Cutscene system</h2>

<p>I’ve written an article about how I write cutscenes with coroutines <a href="https://eliasdaler.github.io/how-to-implement-action-sequences-and-cutscenes/">here</a>. It’s pretty great! A lot of code was simplified and now I can easily write complex action sequences, multi-branch cutscenes and dialogue trees with it. So, with the code like this:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">answer</span> <span class="o">=</span> <span class="n">girl</span><span class="p">:</span><span class="n">say</span><span class="p">(</span><span class="s1">'do_you_love_lua'</span><span class="p">,</span>
                          <span class="p">{</span> <span class="s1">'YES'</span><span class="p">,</span> <span class="s1">'NO'</span> <span class="p">})</span>
<span class="k">if</span> <span class="n">answer</span> <span class="o">==</span> <span class="s1">'YES'</span> <span class="k">then</span>
  <span class="n">girl</span><span class="p">:</span><span class="n">setMood</span><span class="p">(</span><span class="s1">'happy'</span><span class="p">)</span>
  <span class="n">girl</span><span class="p">:</span><span class="n">say</span><span class="p">(</span><span class="s1">'happy_response'</span><span class="p">)</span>
<span class="k">else</span>
  <span class="n">girl</span><span class="p">:</span><span class="n">setMood</span><span class="p">(</span><span class="s1">'angry'</span><span class="p">)</span>
  <span class="n">girl</span><span class="p">:</span><span class="n">say</span><span class="p">(</span><span class="s1">'angry_response'</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>
<p>I get this:</p>

<p><img src="/assets/tomb_painter_first_dev_log/dialogue.gif" alt="Replay system" style="display:block; margin: 0 auto; width: 447px" /></p>

<h2 id="quest-and-saving-system">Quest and saving system</h2>

<p>It’s now possible to have a main quest line in the game, but also side quests with multiple states which are easy to write, modify and read.</p>

<p>Previously, Re:creation had a very simple save system which saved your inventory, main quest progression, etc. But I’ve decided that I needed something more complex for Tomb Painter, to store consequences of NPC interactions or side quest progression. The current system tracks game’s state in real time and saves all important stuff in a Lua table once it happens (by catching events). Then, when you save, this table is just converted to JSON and saved to a file. Pretty awesome!</p>

<h2 id="replay-system">Replay system</h2>

<p>I’ve also implemented a replay system which lets me record all input and then replay it in any speed I want. I can record minutes of gameplay and then run it very fast! I can also use it to quickly repeat some tasks (e.g. kill two enemies than go to room X) and then continue playing the game. Here’s how all this looks in action:</p>

<p><img src="/assets/tomb_painter_first_dev_log/replay.gif" alt="Replay system" style="display:block; margin: 0 auto; width: 447px" /></p>

<h2 id="data--script-separation">Data / script separation</h2>

<p>Previously, I’ve stored all information about prefabs in Lua scripts. But then I’ve decided that they’d look better in JSON and it’ll be much easier to write a GUI tool for modifying prefabs in the future. Here’s an example of how prefab looks:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"slime"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ai"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"chaser"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"viewRadius"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w">
        </span><span class="nl">"viewAngle"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">90</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"animation"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="nl">"collision"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"boundingBox"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="nl">"damage"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"physical"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"graphics"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"spriteOrigin"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="nl">"overlays"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"paint"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"slime_overlay"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"health"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"maxHealth"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="nl">"movement"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"moveSpeed"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">15.0</span><span class="p">,</span><span class="w"> </span><span class="mf">15.0</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="nl">"mass"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"sound"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"sounds"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"hit"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"file"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"enemy_hit"</span><span class="w"> </span><span class="p">},</span><span class="w">
            </span><span class="nl">"die"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"file"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"enemy_die"</span><span class="w"> </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"stateMachine"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"main"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"initialState"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"IdleState"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"transitionTable"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"hero"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"ai"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"initialState"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"AIPatrolState"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"transitionTable"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ai_slime"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>As you can see, it’s easy to read. Transition tables are still written in Lua, because they usually have conditions inside of them and they look like this:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="n">IdleState</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">update</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">entity</span><span class="p">:</span><span class="n">getVelocity</span><span class="p">():</span><span class="n">isZero</span><span class="p">()</span> <span class="k">then</span>
                <span class="k">return</span> <span class="s2">"MoveState"</span>
            <span class="k">end</span>
        <span class="k">end</span>
    <span class="p">},</span>
    <span class="n">MoveState</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">update</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">entity</span><span class="p">:</span><span class="n">getVelocity</span><span class="p">():</span><span class="n">isZero</span><span class="p">()</span> <span class="k">then</span>
                <span class="k">return</span> <span class="s2">"IdleState"</span>
            <span class="k">end</span>
        <span class="k">end</span>
    <span class="p">},</span>
    <span class="n">DyingState</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">EventType</span><span class="p">.</span><span class="n">AnimationFinished</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">animationName</span> <span class="o">==</span> <span class="s2">"dying"</span> <span class="k">then</span>
                    <span class="k">return</span> <span class="s2">"DiedState"</span>
                <span class="k">end</span>
            <span class="k">end</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Update fuction can either call <code class="highlighter-rouge">setState</code> explicitly, or just return a name of the state to transition into. Another way to transition is by catching the event. So, if entity is in <code class="highlighter-rouge">DyingState</code> and it catches <code class="highlighter-rouge">AnimationFinished</code> event, the callback is called where it can then transition into another state.</p>

<h2 id="other">Other</h2>

<p>All GUI widgets are now entities, which is very useful as they can be manipulated as normal game objects and I don’t have any repeating rendering/movement code.</p>

<p>Also, I’ve worked a lot on resource and entity prefab management. Now, entity prefabs are ref counted and if entity prefab is unused on another level, it’s unloaded with all resources which it was using (unless other prefabs use it too). The system is very complex to explain in a few paragraphs and I might write an article about it later.</p>

<p>And there was a lot of refactoring, of course. All the code is now in its best condition ever.</p>

<h2 id="whats-next">What’s next?</h2>

<p><img src="/assets/tomb_painter_first_dev_log/shadows.png" alt="Tomb Painter painting system" style="display:block; margin: 0 auto; width: 480px" /></p>

<p>Right now, my next goal is making game look even prettier shadows (see the screenshot above), animated tiles, a new level, the first boss and the first awesome mini-game. Overall, the progress looks very good and I’m very happy with my engine and I can’t wait to start working on the game again. I’ll also have a lot more time to work on the game (find out why in the next post!), so it’s going to be awesome.</p>

<p>See you soon! Thanks for reading.</p>

    <hr />
    <p>Follow me on twitter <a href="https://twitter.com/EliasDaler">@EliasDaler</a> to not miss the new stuff!</p>
  </div>

</article>
<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//eliasdaler-github-io.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>

  </body>
</html>
